import React, { useState } from 'react';

const CheckoutButton = ({ orderId }) => {
    const [loading, setLoading] = useState(false);

    const handleCheckout = async () => {
        setLoading(true);

        // Request the backend to create a checkout session
        const response = await fetch(`/api/create-checkout-session/${orderId}`, {
            method: 'POST',
        });

        const session = await response.json();

        if (session.url) {
            // Redirect to Stripe Checkout
            window.location.href = session.url;
        } else {
            alert('There was an error creating the checkout session');
        }

        setLoading(false);
    };

    return (
        <button onClick={handleCheckout} disabled={loading}>
            {loading ? 'Loading...' : 'Checkout'}
        </button>
    );
};

export default CheckoutButton;



import React, { useEffect, useState } from 'react';

const PaymentSuccess = () => {
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    const [paymentData, setPaymentData] = useState(null);

    // Extract session_id from the query string
    const queryParams = new URLSearchParams(window.location.search);
    const sessionId = queryParams.get('session_id');

    useEffect(() => {
        const fetchPaymentDetails = async () => {
            if (sessionId) {
                try {
                    const response = await fetch(`/api/payment/success/?session_id=${sessionId}`);
                    const data = await response.json();
                    
                    if (response.ok) {
                        setPaymentData(data.session);  // Set session data received from backend
                    } else {
                        setError(data.error);  // Handle error from server
                    }
                } catch (error) {
                    setError('There was an error processing your payment.');
                }
            } else {
                setError('Session ID is missing.');
            }

            setLoading(false);
        };

        fetchPaymentDetails();
    }, [sessionId]);

    if (loading) {
        return <div>Loading...</div>;
    }

    if (error) {
        return <div>{error}</div>;
    }

    return (
        <div>
            <h2>Payment Successful!</h2>
            <p>Order ID: {paymentData.id}</p>
            <p>Payment Status: {paymentData.payment_status}</p>
            <p>Total Amount: ${paymentData.amount_total / 100}</p>
            {/* You can display more session data as needed */}
        </div>
    );
};

export default PaymentSuccess;




import React from 'react';

const PaymentCancel = () => {
    return (
        <div>
            <h2>Payment Cancelled</h2>
            <p>Your payment was cancelled. You can go back and try again.</p>
            <a href="/orders">Go back to your orders</a>
        </div>
    );
};

export default PaymentCancel;
